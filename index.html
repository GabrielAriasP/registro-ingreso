<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Registro de Ingreso</title>
</head>
<body>
    <h2>Registro de Ingreso</h2>
    <form id="registroForm">
        <input type="text" id="nombre" placeholder="Nombre" required><br>
        <select id="tipo" required>
            <option value="Peatonal">Peatonal</option>
            <option value="Vehicular">Vehicular</option>
        </select><br>
        <input type="text" id="patente" placeholder="Patente"><br>
        <input type="text" id="punto" placeholder="Punto de Ingreso" required><br>
        <button type="submit">Registrar</button>
    </form>
    <p id="mensaje"></p>


https://script.google.com/macros/s/AKfycbwlAtUcYxILxyQSw6BNwu22fME_vW34x4X6dAJ4lbpdejR8qRfWYtLLTVzWB_oFJjUj/exec
    
   <script>
    const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQqdJUWByFwR8o1TklqmKSDXmf8NSRDnWW4D6PLwoaT0NedOfdx9iu8UTwEraWgppwollXWjBVK5w03/pub?output=csv';

    document.getElementById('registroForm').addEventListener('submit', function(e) {
        e.preventDefault();

        const nombre = document.getElementById('nombre').value;
        const tipo = document.getElementById('tipo').value;
        const patente = document.getElementById('patente').value;
        const punto = document.getElementById('punto').value;
        const hora = new Date().toLocaleString();

        fetch('https://script.google.com/macros/s/AKfycbwlAtUcYxILxyQSw6BNwu22fME_vW34x4X6dAJ4lbpdejR8qRfWYtLLTVzWB_oFJjUj/exec', {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ nombre, tipo, patente, punto, hora })
        })
        .then(() => {
            document.getElementById('mensaje').innerText = 'Registro enviado correctamente.';
            document.getElementById('registroForm').reset();
            actualizarTabla(); // Refrescar después de enviar
        })
        .catch(error => {
            console.error('Error:', error);
            document.getElementById('mensaje').innerText = 'Error al enviar el registro.';
        });
    });

    function actualizarTabla() {
        fetch(CSV_URL)
            .then(response => response.text())
            .then(csvText => {
                const lines = csvText.split('\n').filter(line => line.trim() !== '');
                const tbody = document.querySelector('#tablaRegistros tbody');
                tbody.innerHTML = '';

                // Saltar la cabecera
                for (let i = 1; i < lines.length; i++) {
                    const columns = lines[i].split(',');
                    if (columns.length >= 5) {
                        const row = `<tr>
                                        <td>${columns[0]}</td>
                                        <td>${columns[1]}</td>
                                        <td>${columns[2]}</td>
                                        <td>${columns[3]}</td>
                                        <td>${columns[4]}</td>
                                     </tr>`;
                        tbody.innerHTML += row;
                    }
                }
            });
    }

    document.getElementById('exportar').addEventListener('click', function() {
        window.open(CSV_URL, '_blank');
    });

    // Actualización automática cada 5 segundos
    setInterval(actualizarTabla, 5000);
    actualizarTabla(); // Cargar al inicio
</script>
</body>
</html>


